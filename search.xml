<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>vim 操作与配置</title>
      <link href="2021/vim-cao-zuo-yu-pei-zhi/"/>
      <url>2021/vim-cao-zuo-yu-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>VIM 基本操作。</p><h1>技巧</h1><p><strong>实时加密文本</strong></p><pre class="line-numbers language-none"><code class="language-none">加密指令： ggVGg?g? 使用 ROT13 对选择文本进行编码（对中文无效）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>文本加密解密</strong></p><pre class="line-numbers language-none"><code class="language-none">1. 加密指令:X输入密码:wq 保存退出2. 解密指令:X输入密码为空（即回车）:w 保存<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>80 列高亮及换行</strong></p><pre class="line-numbers language-none"><code class="language-none">set colorcolumn&#x3D;80    &quot;高亮显示 80 列set textwidth&#x3D;80      &quot;80 列自动换行set formatoptions+&#x3D;mM &quot;针对中文不能自动换行对已存在的文本应用自动换行只需要选中它们，然后按 &#96;gq&#96; 即可。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>统计汉字</strong></p><pre class="line-numbers language-none"><code class="language-none">&quot; 包括标点符号:% s&#x2F;[^\x00-\xff]&#x2F;&#x2F;gn&quot; 不包括标点符号:s&#x2F;[\u4E00-\u9FCC]&#x2F;&#x2F;n  &quot; 统计选中区域:%s&#x2F;[\u4E00-\u9FCC]&#x2F;&#x2F;gn  &quot; 统计全文&quot; 显示字数统计，将汉字、标点、空格、英文字母都看做一个字g CTRL-G<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>取消高亮</strong></p><pre class="line-numbers language-none"><code class="language-none">:noh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1>折叠</h1><pre class="line-numbers language-none"><code class="language-none">折叠分为手动折叠和自动折叠手动折叠和 foldlevel 无关自动折叠受 foldlevel 约束<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol><li>foldenable</li></ol><pre class="line-numbers language-none"><code class="language-none">是否打开折叠功能（即包括手动折叠，也包括自动折叠）zi 相当于该选项的 toggle<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="2"><li>foldlevel</li></ol><pre class="line-numbers language-none"><code class="language-none">用于自动折叠（层数高于 foldlevel 的将被自动折叠）zr 和 zm 相当于加减 foldlevelzR 和 zM 相当于设置 foldlevel 最大最小值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="3"><li>创建折叠</li></ol><pre class="line-numbers language-none"><code class="language-none">选中，然后 zf （visual）zf10G （motion）10zf+ （count）zf%   （大括号匹配）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>删除折叠</li></ol><pre class="line-numbers language-none"><code class="language-none">zdzDzE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="5"><li>保存和加载折叠</li></ol><pre class="line-numbers language-none"><code class="language-none">mkviewloadview<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="6"><li>打开和关闭折叠</li></ol><pre class="line-numbers language-none"><code class="language-none">zc（zC）zo（zO）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1>字体 guifont 设置</h1><p>从网上下载相关字体，通过配置 guifont 和 guifontwide 来实现。问题在于如何正确的设置字体的名字。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; 通过 GUI 界面选择已安装字体:set guifont&#x3D;*&lt;CR&gt;&quot; 查看选择好的字体配置:set guifont?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>把 guifont 设置内容写入 vimrc 即可。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">set guifont&#x3D;DaddyTimeMono_Nerd_Font_Mono:h10:cANSI:qDRAFT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1>状态行 Statusline</h1><p><strong>定制状态行</strong></p><p>vim 默认的状态行，左侧显示当前打开的文件名，右侧显示当前所处的行列位置。</p><p>可以用命令 <code>:set statusline=format</code> 来定义状态行。</p><ul><li><code>format</code> 选项参数以 <code>%</code> 开始，中间可以夹杂普通文本。</li><li>内容默认右对齐，若想左对齐，可在 <code>%</code> 后加上 <code>-</code>。</li><li>数字内容是忽略开头 0 显示的，若要显示，可在 <code>%</code> 后加一个 <code>0</code>。</li><li>单个百分号为 <code>%%</code>。</li><li>若选项以 <code>%!</code> 开始，则用作表达式，表达式的结果作为选项值。</li><li>最多可以给出 80 个选项。</li></ul><p><img src="/2021/vim-cao-zuo-yu-pei-zhi/vim-statusline-parameters.png" alt="参数列表"></p><p><strong>显示/隐藏状态行</strong></p><p>vim 在默认情况下是不显示状态行的，而仅显示命令缓冲区等极少的信息。</p><p>通过命令 <code>:set laststatus=2</code> 将状态行显示在窗口底部倒数第二行。</p><p>也可以通过命令 <code>:set laststatus=0</code> 移除状态行。</p><p>以上所有命令去掉冒号，写入配置文件即可永久生效。</p><h1>修订记录</h1><ul><li><p>2021-01-12</p><p>从其它网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> vim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim win10 源码安装</title>
      <link href="2021/vim-yuan-ma-an-zhuang/"/>
      <url>2021/vim-yuan-ma-an-zhuang/</url>
      
        <content type="html"><![CDATA[<p>win10 msys2 vim 源码安装。</p><p><a href="https://github.com/yianwillis/vimcdoc/releases">参考手册</a>。</p><h1>MSYS2</h1><ol><li><p>在 <a href="https://www.msys2.org/">官网</a> 下载 MSYS2 并安装安装到合适位置。</p></li><li><p>添加 mingw64/bin 到环境变量。</p></li><li><p>修改软件源。</p><p>软件源文件 <code>/etc/pacman.d/mirrorlist.mingw32</code></p><p>注释掉所有源，添加</p><p><code>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/mingw/i686</code></p><p>软件源文件 <code>/etc/pacman.d/mirrorlist.mingw64</code></p><p>注释掉所有源，添加</p><p><code>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/mingw/x86_64</code></p><p>软件源文件 <code>/etc/pacman.d/mirrorlist.msys</code></p><p>注释掉所有源，添加</p><p><code>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/msys/$arch</code></p></li><li><p>更新软件源</p></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman -Syu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>安装编译环境</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman -S mingw-w64-x86_64-gcc mingw-w64-x86_64-gdb mingw-w64-x86_64-make <span class="token function">git</span> diffutils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="6"><li>验证安装</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc --version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1>Python 2.7</h1><p>下载 Python 并安装到合适位置，添加环境变量。</p><h1>编译 vim</h1><ol><li>下载 vim 源码到合适位置</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/vim/vim.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>修改编译配置 <code>custom.mak</code></li></ol><p>跳转至 vim 源码 src 目录。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> Make_cyg_ming.mak custom.mak<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-make" data-language="make"><code class="language-make">GUI&#x3D;yes         #vim 带图形界面ARCH&#x3D;x86-64     #指定为 64 位系统编译<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>找到 Python 选项，本次编译使用 27 版本。</p><ol start="3"><li>编译安装</li></ol><p>在 src 目录下编译。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mingw32-make.exe -f custom.mak<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>若编译失败，想重新编译，可先 <code>clean</code> 重新执行以上命令。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mingw32-make.exe -f custom.mak clean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="4"><li>编译成功后打包</li></ol><p>在 <code>src</code> 父目录创建打包文件 <code>pkg.sh</code> 内容为：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> -p vim-x64/vim81<span class="token function">cp</span> -a runtime/* vim-x64/vim81<span class="token function">cp</span> -a src/*.exe vim-x64/vim81<span class="token function">cp</span> -a src/GvimExt/gvimext.dll vim-x64/vim81<span class="token function">cp</span> -a src/xxd/xxd.exe vim-x64/vim81<span class="token function">cp</span> -a vimtutor.bat vim-x64/vim81<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li>vim-x64/vim81 即为编译好的 vim 版本</li></ol><p>将 vim81 移到合适的位置，以管理员的权限执行 <code>install.exe</code> 文件。</p><p>根据提示选择编号，选择 d 进行安装。</p><h1>添加右键 <code>用 vim 打开</code></h1><ol><li>打开注册表：计算机 <code>\HKEY_CLASSES_ROOT\*\shell\</code>。</li><li>新建项，命名为 <code>用 VIM 编辑</code>。</li><li>在该项右键新建字符串值 <code>Icon</code>，内容为 <code>&quot;/path/to/gvim.exe,0&quot;</code>。</li><li>继续在该项右键新建项 <code>Command</code>，修改默认值为 <code>/path/to/gvim.exe -p --remote-tab-silent &quot;%1&quot;</code>。</li></ol><h1>修订记录</h1><ul><li><p>2021-01-11</p><p>从其它网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> vim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>websocket + tls + web + cdn VPN 搭建</title>
      <link href="2021/websocket-pei-cdn-de-vpn-da-jian/"/>
      <url>2021/websocket-pei-cdn-de-vpn-da-jian/</url>
      
        <content type="html"><![CDATA[<p>为进一步增强安全性，VPN 采用 websocket + tls + web + cdn 的策略。</p><h1>域名</h1><p>登录 <a href="http://www.freenom.com/zh/index.html">freenom</a> 网站申请一个免费域名。</p><p>若没账号可先申请域名，会要求邮箱验证，验证后会要求注册，就是先上车后补票。</p><p>在 <em>view cart</em> 中完成购买（我重复了好多次，每次购买完成就自动退出账号，购买失败。最后在手机上重复了 N 次终于成功）。</p><h1>安装 caddy v2</h1><p>登录服务器，运行命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"deb [trusted=yes] https://apt.fury.io/caddy/ /"</span> <span class="token punctuation">\</span>    <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/apt/sources.list.d/caddy-fury.list<span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> caddy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置文件位置 <em>/etc/caddy/Caddyfile</em>。</p><p>https/ssl 证书位置 <em>/var/lib/caddy</em>。</p><p><strong>Caddy v1 和 v2 的语法不同</strong>。</p><h1>配置</h1><h2 id="cloudflare-配置">cloudflare 配置</h2><p><em>添加站点</em> -&gt; 选择 <em>Free</em> 计划 -&gt; <em>添加记录</em></p><table><thead><tr><th>类型</th><th>名称</th><th>内容</th><th>TTL</th><th>代理状态</th></tr></thead><tbody><tr><td>A</td><td>刚刚申请的域名</td><td>服务器地址</td><td>自动</td><td>仅限 DNS</td></tr></tbody></table><p>继续，cloudflare 要求 <em>更改您的名称服务器</em>，将两个 nameserver 添加到 freenom 自定义 nameserver 完成。</p><p>稍等片刻新申请的域名即可使用，在 <em>SSL/TLS</em> 将模式设置为 <em>完全</em>。</p><h2 id="freenom-域名配置">freenom 域名配置</h2><p><em>gServices</em> -&gt; <em>My Domains</em> -&gt; <em>Manage Domain</em> -&gt; <em>Management Tools</em> -&gt; <em>Nameservers</em></p><p>选择 <em>Use custom nameservers (enter below)</em>。</p><p>添加从 cloudflare 新申请的域名获取的名称服务器（在 <em>DNS</em> 选项）。</p><h2 id="caddy-配置">caddy 配置</h2><pre class="line-numbers language-caddy" data-language="caddy"><code class="language-caddy">&#123;    email your@email&#125;your.domain &#123;    log &#123;        output file &#x2F;etc&#x2F;caddy&#x2F;caddy.log    &#125;    tls &#123;        protocols tls1.2 tls1.3        ciphers TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256        curves x25519    &#125;    @v2ray_websocket &#123;        path &#x2F;ray                                       &#x2F;&#x2F; 证书位置要和 v2ray 客户端位置保持一致        header Connection *Upgrade*        header Upgrade websocket    &#125;    reverse_proxy @v2ray_websocket localhost:10250      &#x2F;&#x2F; 端口和 v2ray 服务端 inbound 保持一致&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启 caddy 服务 <code>systemctl restart caddy</code>。</p><h2 id="v2fly-服务端配置">v2fly 服务端配置</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"loglevel"</span><span class="token operator">:</span> <span class="token string">"warning"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"routing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"domainStrategy"</span><span class="token operator">:</span> <span class="token string">"AsIs"</span><span class="token punctuation">,</span>        <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">&#123;</span>                <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token string">"geoip:private"</span>                <span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"blocked"</span><span class="token punctuation">,</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"inbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">10250</span><span class="token punctuation">,</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"vmess"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"clients"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">&#123;</span>                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>                        <span class="token property">"alterId"</span><span class="token operator">:</span> <span class="token number">64</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"streamSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"network"</span><span class="token operator">:</span> <span class="token string">"ws"</span><span class="token punctuation">,</span>                <span class="token property">"wsSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                     <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"/ray"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"outbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"freedom"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"blackhole"</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"blocked"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启 v2ray 服务 <code>systemctl restart v2ray</code>。</p><h2 id="v2fly-客户端配置">v2fly 客户端配置</h2><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"loglevel"</span><span class="token operator">:</span> <span class="token string">"warning"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"inbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>    <span class="token property">"listen"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>    <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"proxy"</span><span class="token punctuation">,</span>    <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"socks"</span><span class="token punctuation">,</span>    <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"auth"</span><span class="token operator">:</span> <span class="token string">"noauth"</span><span class="token punctuation">,</span>      <span class="token property">"udp"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"sniffing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"destOverride"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http"</span><span class="token punctuation">,</span> <span class="token string">"tls"</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"outbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"vmess"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"vnext"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">&#123;</span>                        <span class="token property">"users"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                            <span class="token punctuation">&#123;</span>                                <span class="token property">"alterId"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>                                <span class="token property">"security"</span><span class="token operator">:</span> <span class="token string">"none"</span><span class="token punctuation">,</span>                                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"xxx"</span>                 <span class="token comment">// 和服务端保持一致</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">]</span><span class="token punctuation">,</span>                        <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">443</span><span class="token punctuation">,</span>                        <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"new domain"</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"streamSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"network"</span><span class="token operator">:</span> <span class="token string">"ws"</span><span class="token punctuation">,</span>                <span class="token property">"security"</span><span class="token operator">:</span> <span class="token string">"tls"</span><span class="token punctuation">,</span>                <span class="token property">"wsSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"/ray"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"blackhole"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"adblock"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"freedom"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"routing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"domainStrategy"</span><span class="token operator">:</span> <span class="token string">"IPOnDemand"</span><span class="token punctuation">,</span>    <span class="token property">"rules"</span><span class="token operator">:</span><span class="token punctuation">[</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"tanx.com"</span><span class="token punctuation">,</span>          <span class="token string">"googeadsserving.cn"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"adblock"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"geoip:private"</span><span class="token punctuation">,</span>          <span class="token string">"geoip:cn"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"geosite:cn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置并重启 caddy 和 v2fly，登录 cloudflare，配置新域名 DNS 记录，将代理状态由 *仅限DNS* 切换为 <em>已代理</em>。</p><h1>修订记录</h1><ul><li><p>2021-01-11</p><p>从其它网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> VPN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> caddy </tag>
            
            <tag> vpn </tag>
            
            <tag> cdn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单模型 VPN 搭建</title>
      <link href="2021/jian-dan-mo-xing-de-vpn-da-jian/"/>
      <url>2021/jian-dan-mo-xing-de-vpn-da-jian/</url>
      
        <content type="html"><![CDATA[<p>采用 <em>v2ray/v2fly</em> 工具搭建 VPN 服务器。</p><h1>VPS 主机购买</h1><p>逢年过节各大 VPS 供应商会有各种优惠活动，可参考 <a href="https://www.zhujiceping.com/">国外主机测评</a> 了解详细信息。</p><p>购买主机选择 OS 时，至少选择 <strong>Ubuntu 16.04 64 位</strong> 操作系统。（<font color="red">v2ray 运行在 init 系统为 <em>systemd</em> 的操作系统上</font>）。</p><h2 id="virmach">virmach</h2><ol><li><p>注册 <a href="https://virmach.com/">virmach</a> 账号。</p></li><li><p>在 <em>Order New Services</em> 中选择适合主机，网上查找优惠码，使用支付宝支付。</p></li><li><p>付款成功后会收到一封邮件，包括主机 IP、OS 登录账户和密码。</p></li><li><p>可使用 putty 远程 ssh 登录。也可使用 virmach 控制面板 <em>VNC/Desktop</em> 工具登录。</p></li><li><p>修改 Ubuntu 登录密码</p><ul><li><p>按照官方说明，首先尝试在 <em>control panel</em> 中修改 <em>root/Admin</em> Password。若不成功则关闭主机重新修改，若还不成只能求助技术支持了。</p></li><li><p>若无法在 <em>control panel</em> 修改密码，可以在 VNC 中使用指令 <em>passwd</em> 修改root 密码。此时虽然 root 密码已被修改，但是控制面板显示的密码并没有改变。</p></li></ul></li></ol><h2 id="racknerd">racknerd</h2><p>和 virmach 流程基本一样。</p><ol><li><p>注册 <a href="https://www.racknerd.com/">racknerd</a> 账号。</p></li><li><p>购机后会收到一封邮件，包括主机 IP、OS 登录账号和密码、<em>control panel</em> 账号和密码。</p></li><li><p>可以所使用的 putty 远程 ssh 登录，使用 <em>passwd</em> 指令直接修改 <em>root</em> 登录密码。</p></li></ol><h1>v2ray 安装及配置</h1><h2 id="服务端">服务端</h2><ol><li>安装 <a href="https://github.com/v2fly/fhs-install-v2ray">v2ray/v2fly</a></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 安装必备工具</span><span class="token function">apt</span> <span class="token function">install</span> <span class="token function">curl</span><span class="token comment"># 下载 v2ray/v2fly</span><span class="token function">curl</span> -O https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh<span class="token comment"># 安装</span><span class="token function">bash</span> install-release.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>配置文件</li></ol><pre class="line-numbers language-template" data-language="template"><code class="language-template">&#x2F;usr&#x2F;local&#x2F;etc&#x2F;v2ray&#x2F;config.json<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li><a href="https://github.com/v2fly/v2ray-examples">配置模板</a></li></ol><pre class="line-numbers language-template" data-language="template"><code class="language-template">https:&#x2F;&#x2F;github.com&#x2F;v2fly&#x2F;v2ray-examples<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="4"><li>配置内容</li></ol><p>注意 json 格式。</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"loglevel"</span><span class="token operator">:</span> <span class="token string">"warning"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"routing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"domainStrategy"</span><span class="token operator">:</span><span class="token string">"AsIs"</span><span class="token punctuation">,</span>        <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">&#123;</span>                <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token string">"geoip:private"</span>                <span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"blocked"</span><span class="token punctuation">,</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"inbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">1234</span><span class="token punctuation">,</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"vmess"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"udp"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token property">"clients"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">&#123;</span>                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"92be9285-52eb-4666-bb92-eae0e608ca8a"</span><span class="token punctuation">,</span>                        <span class="token property">"alterId"</span><span class="token operator">:</span> <span class="token number">4</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"streamSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"network"</span><span class="token operator">:</span> <span class="token string">"mkcp"</span><span class="token punctuation">,</span>                <span class="token property">"kcpSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"uplinkCapacity"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>                    <span class="token property">"downlinkCapacity"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>                    <span class="token property">"congestion"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                    <span class="token property">"header"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"none"</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"outbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"freedom"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"blackhole"</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"blocked"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li>启动 v2ray/v2fly</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl <span class="token builtin class-name">enable</span> v2raysystemctl start v2ray<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="客户端">客户端</h2><ol><li>客户端地址</li></ol><ul><li><p><a href="https://github.com/v2fly/v2ray-core/releases"> <code>v2ray-core</code> </a> 各个 PC 平台不带图形界面，通过配置文件 <code>config.json</code> 使用。</p></li><li><p><a href="https://github.com/2dust/v2rayNG/releases"> <code>v2rayNG</code> </a> Android 平台可使用。</p></li><li><p><a href="https://github.com/2dust/v2rayN/releases"> <code>v2rayN</code> </a> Windows 平台带图形界面。</p></li></ul><ol start="2"><li>配置内容</li></ol><p>注意 json 格式，双斜杠注释内容在 config 配置文件中包括双斜杠在内都要去除。</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"loglevel"</span><span class="token operator">:</span> <span class="token string">"warning"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"inbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">2080</span><span class="token punctuation">,</span>                       <span class="token comment">// 须和浏览器代理保持一致</span>    <span class="token property">"listen"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>              <span class="token comment">// 同上</span>    <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"proxy"</span><span class="token punctuation">,</span>    <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"socks"</span><span class="token punctuation">,</span>                <span class="token comment">// 同上 socks v5</span>    <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"auth"</span><span class="token operator">:</span> <span class="token string">"noauth"</span><span class="token punctuation">,</span>      <span class="token property">"udp"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"sniffing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"destOverride"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http"</span><span class="token punctuation">,</span> <span class="token string">"tls"</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"outbounds"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"vmess"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"vnext"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">&#123;</span>                        <span class="token property">"users"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                            <span class="token punctuation">&#123;</span>                                <span class="token property">"alterId"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>                                <span class="token property">"security"</span><span class="token operator">:</span> <span class="token string">"none"</span><span class="token punctuation">,</span>                                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"92be9285-52eb-4666-bb92-eae0e608ca8a"</span> <span class="token comment">// 需要和服务器端 inbounds 的 id 保持一致</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">]</span><span class="token punctuation">,</span>                        <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">1234</span><span class="token punctuation">,</span>                                       <span class="token comment">// 同上</span>                        <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"xxx.xxx.xx.xxx"</span>                         <span class="token comment">// 服务器地址</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"streamSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"network"</span><span class="token operator">:</span> <span class="token string">"mkcp"</span><span class="token punctuation">,</span>                                          <span class="token comment">// 最简单方式直接设置为 tcp，需要和服务端 inbounds 保持一致</span>                <span class="token property">"kcpSettings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"uplinkCapacity"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>                    <span class="token property">"downlinkCapacity"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>                    <span class="token property">"congestion"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                    <span class="token property">"header"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"none"</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"blackhole"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"adblock"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"freedom"</span><span class="token punctuation">,</span>            <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"tag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"routing"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                                          <span class="token comment">// 路由</span>    <span class="token property">"domainStrategy"</span><span class="token operator">:</span> <span class="token string">"IPOnDemand"</span><span class="token punctuation">,</span>    <span class="token property">"rules"</span><span class="token operator">:</span><span class="token punctuation">[</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"tanx.com"</span><span class="token punctuation">,</span>          <span class="token string">"googeadsserving.cn"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"adblock"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"geoip:private"</span><span class="token punctuation">,</span>          <span class="token string">"geoip:cn"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token punctuation">&#123;</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"field"</span><span class="token punctuation">,</span>        <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"geosite:cn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"outboundTag"</span><span class="token operator">:</span> <span class="token string">"direct"</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="v2rayNG-设置">v2rayNG 设置</h3><p>在右上角 <em>+</em> 选择 <em>手动输入 [Vmess]</em></p><ul><li><p>别名 <strong>v2ray</strong></p></li><li><p>地址 <strong>服务器 IP</strong></p></li><li><p>端口 <strong>和服务器保持一致</strong></p></li><li><p>用户 ID <strong>和服务器的用户 ID 保持一致</strong></p></li><li><p>额外 ID(alterID) <strong>和服务器保持一致</strong></p></li><li><p>加密方式 <strong>none</strong></p></li><li><p>底层传输方式 <strong>tcp</strong></p></li><li><p>伪装类型 <strong>none</strong></p></li><li><p>跳过证书验证 <strong>true</strong></p></li></ul><h1>chrome 代理</h1><p>Chrome 推荐代理插件<a href="https://github.com/FelisCatus/SwitchyOmega/releases">SwitchyOmega</a>。</p><ul><li><p>插件网 <em><a href="http://www.cnplugins.com/">http://www.cnplugins.com/</a></em> 上面把代理相关的全禁了，真闲的蛋疼。</p></li><li><p>新版 Chrome 不能直接安装 crx 文件，把 crx 尾缀修改为 zip 拖到 Chrome 的拓展程序即可。此离线安装方法重启 Chrome 后失效，需要重新操作一遍。</p></li><li><p>最好的方法是通过 Chrome 商店安装，但需要翻墙（开启 v2ray 的 HTTP 代理全局模式）。</p></li></ul><h2 id="SwitchOmega-设置">SwitchOmega 设置</h2><p>在左侧的情景模式中，默认有 <em>proxy</em>、<em>auto switch</em> 和 <em>新建情景模式…</em>。可以通过<em>新建情景模式…</em> 来创建新的 <em>代理服务器</em> 和 <em>自动切换模式</em>。使用默认的两种模式已经满足需求了。</p><ol><li><em>代理服务器 proxy</em></li></ol><p>proxy 配置需要和 v2ray 客户端 inbounds 参数保持一致。</p><table><thead><tr><th style="text-align:center">网址协议</th><th style="text-align:center">代理协议</th><th style="text-align:center">代理服务器</th><th style="text-align:center">代理端口</th></tr></thead><tbody><tr><td style="text-align:center">（默认）</td><td style="text-align:center">SOCKS5</td><td style="text-align:center">127.0.0.1</td><td style="text-align:center">2080</td></tr></tbody></table><ol start="2"><li><em>自动切换模式 auto switch</em></li></ol><p>主要作用是将特定情景模式（代理）应用到具有某种模式的网址，实现自动根据网站适配不同代理。</p><ul><li><p>切换规则</p><table><thead><tr><th style="text-align:center">条件类型</th><th style="text-align:center">条件设置</th><th style="text-align:center">情景模式</th><th style="text-align:center">操作</th></tr></thead><tbody><tr><td style="text-align:center">域名通配符</td><td style="text-align:center">*<a href="http://youtube.com">youtube.com</a>*</td><td style="text-align:center">proxy</td><td style="text-align:center">-</td></tr></tbody></table><p>当我浏览 YouTube 时，自动会切换到 proxy 代理。</p></li><li><p>规则列表设置</p><p>规则列表网址：<em><a href="https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt">https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt</a></em></p><p>点击 <em>立即更新情景模式</em>。</p></li></ul><h1>问题</h1><ol><li><p>failed to process outbound traffic</p><pre class="line-numbers language-template" data-language="template"><code class="language-template">感觉造成这个问题的原因很多，烦不胜烦。1. 网络差。2. Ubuntu 服务器 MTU 包莫名丢失，调整 MTU 值为 1280 以下。   # vi &#x2F;etc&#x2F;network&#x2F;interfaces   #增加如下值   mtu 9000   #保存后，重启网络生效   # &#x2F;etc&#x2F;init.d&#x2F;networking restart3. 服务器和本地时间不同步，同步二者时间。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h1>修改记录</h1><ul><li><p>2020-09-19</p><p>virmach VPN 搭建。</p></li><li><p>2021-01-01</p><p>增加 racknerd 部分；修改服务端配置文件语法错误；增加 v2ray 各个平台下载地址；增加 SwitchyOmega 规则列表设置；增加问题模块。</p></li><li><p>2021-01-02</p><p>SwitchOmega Chrome 重启失效修复。</p></li><li><p>2021-01-10</p><p>从旧网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> VPN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vpn </tag>
            
            <tag> v2fly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周易</title>
      <link href="2021/zhou-yi-bi-ji/"/>
      <url>2021/zhou-yi-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>易、八卦、六十四卦、五行、干支。</p><h1>易</h1><h2 id="三易">三易</h2><p>易有三易，一曰《连山易》，二曰《归藏易》，三曰《周易》。</p><p>《连山易》是神农时代的《易》，从 <em>艮卦</em> 开始；《归藏易》是黄帝时代的《易》，从 *坤卦* 开始；《周易》则从 <em>乾卦</em> 开始。其中前两者只在江湖上传承了，如医药、堪舆及道家这一方面的东西。</p><p>《周易》名之由来，其一，周文王拘在羑里推演周易，是周代的易，故称《周易》；其二，<em>周</em> 表示周详，易可以演绎万事万物，所以称为《周易》。</p><h2 id="三原则">三原则</h2><ol><li>变易。万事万物没有什么东西是不变的，时间，空间，乃至思想都无时无刻不在变化</li><li>简易。把变化复杂的事物精简成八卦，做到乾坤在手。</li><li>不易。虽然万事万物都在变化，但衍生出万事万物的根本是不变化的。</li></ol><h2 id="三法则：理、象、数">三法则：理、象、数</h2><p>宇宙间万事万物既有它的理，也必有它的象；反过来说，宇宙间的任何一个现象，也一定有它的理，同时每个现象，又一定有它的数。</p><h2 id="研究方法">研究方法</h2><blockquote><p>玩索而有得。        ——孔子</p></blockquote><h1>卦</h1><p>卦者挂也。</p><h2 id="八卦口诀">八卦口诀</h2><blockquote><p>乾三连。坤六断。</p><p>震仰盂。艮覆碗。</p><p>离中虚。坎中满。</p><p>兑上缺。巽下断。</p></blockquote><h2 id="八卦方位图">八卦方位图</h2><p>左东右西，上南下北。</p><p><img src="/2021/zhou-yi-bi-ji/%E6%96%B9%E4%BD%8D%E5%9B%BE.png" alt="八卦方位图"></p><h2 id="先天八卦（伏羲八卦方位图）">先天八卦（伏羲八卦方位图）</h2><p>八卦的卦爻是自下向上画的，由内而外。</p><p><img src="/2021/zhou-yi-bi-ji/%E5%85%88%E5%A4%A9%E5%85%AB%E5%8D%A6%E5%9B%BE.png" alt="先天八卦图"></p><blockquote><p>先天八卦卦序：</p><p>乾一、兑二、离三、震四，巽五、坎六、艮七、坤八。</p></blockquote><blockquote><p>《说卦传》：</p><p>天地定位，山泽通气，雷泽相薄，水火不相射。八卦相错。</p></blockquote><h2 id="后天八卦（文王八卦方位图）">后天八卦（文王八卦方位图）</h2><p><img src="/2021/zhou-yi-bi-ji/%E5%90%8E%E5%A4%A9%E5%85%AB%E5%8D%A6%E5%9B%BE%E5%8F%8A%E6%96%B9%E5%9B%BE.png" alt="后天八卦图及方图"></p><blockquote><p>后天八卦卦序歌：</p><p>一数坎兮二数坤，三震四巽数中分，</p><p>五寄中宫六乾是，七兑八艮九离门。</p></blockquote><blockquote><p>《说卦传》</p><p>帝出乎震。齐乎巽。相见乎离。</p><p>致役乎坤。说言乎兑。战乎乾。</p><p>劳乎坎。成言乎艮。</p></blockquote><h2 id="六十四卦卦序歌">六十四卦卦序歌</h2><blockquote><p>乾坤屯蒙需讼师，比小畜兮履泰否。</p><p>同人大有谦豫随，蛊临观兮噬嗑贲。</p><p>剥复无妄大畜颐，大过坎离三十备。</p><p>咸恒遁兮及大壮，晋与明夷家人睽。</p><p>蹇解损益夬姤萃，升困井革鼎震继。</p><p>艮渐归妹丰旅巽，兑涣节兮中孚至。</p><p>小过既济兼未济，是为下经三十四。</p></blockquote><h2 id="分宫卦象次序">分宫卦象次序</h2><p>乾坎艮震为阳四宫，巽离坤兑为阴四宫，每宫阴阳八卦。</p><table><thead><tr><th>乾为天</th><th>天风姤</th><th>天山遁</th><th>天地否</th><th>风地观</th><th>山地剥</th><th>火地晋</th><th>火天大有</th></tr></thead><tbody><tr><td>坎为水</td><td>水泽节</td><td>水雷屯</td><td>水火既济</td><td>泽火革</td><td>雷火丰</td><td>地火明夷</td><td>地水师</td></tr><tr><td>艮为山</td><td>山火贲</td><td>山天大畜</td><td>山泽损</td><td>火泽睽</td><td>天泽履</td><td>风泽中孚</td><td>风山渐</td></tr><tr><td>震为雷</td><td>雷地豫</td><td>雷水解</td><td>雷风恒</td><td>地风升</td><td>水风井</td><td>泽风大过</td><td>泽雷随</td></tr><tr><td>巽为风</td><td>风天小畜</td><td>风火家人</td><td>风雷益</td><td>天雷无妄</td><td>火雷筮盍</td><td>山雷颐</td><td>山风蛊</td></tr><tr><td>离为火</td><td>火山旅</td><td>火风鼎</td><td>火水未济</td><td>山水蒙</td><td>风水涣</td><td>天水讼</td><td>天火同人</td></tr><tr><td>坤为地</td><td>地雷复</td><td>地泽临</td><td>地天泰</td><td>雷天大壮</td><td>泽天夬</td><td>水天需</td><td>水地比</td></tr><tr><td>兑为泽</td><td>泽水困</td><td>泽地萃</td><td>泽山咸</td><td>水山蹇</td><td>地山谦</td><td>雷山小过</td><td>雷泽归妹</td></tr></tbody></table><h2 id="六十四卦方圆图">六十四卦方圆图</h2><p><img src="/2021/zhou-yi-bi-ji/%E6%96%B9%E5%9C%86%E5%9B%BE.png" alt="方圆图"></p><h3 id="方图数字图">方图数字图</h3><table><thead><tr><th style="text-align:center">坤8</th><th style="text-align:center">艮7</th><th style="text-align:center">坎6</th><th style="text-align:center">巽5</th><th style="text-align:center">震4</th><th style="text-align:center">离3</th><th style="text-align:center">泽2</th><th style="text-align:center">乾1</th></tr></thead><tbody><tr><td style="text-align:center">8<br>8</td><td style="text-align:center">7<br>8</td><td style="text-align:center">6<br>8</td><td style="text-align:center">5<br>8</td><td style="text-align:center">4<br>8</td><td style="text-align:center">3<br>8</td><td style="text-align:center">2<br>8</td><td style="text-align:center">1<br>8</td></tr><tr><td style="text-align:center">8<br>7</td><td style="text-align:center">7<br>7</td><td style="text-align:center">6<br>7</td><td style="text-align:center">5<br>7</td><td style="text-align:center">4<br>7</td><td style="text-align:center">3<br>7</td><td style="text-align:center">2<br>7</td><td style="text-align:center">1<br>7</td></tr><tr><td style="text-align:center">8<br>6</td><td style="text-align:center">7<br>6</td><td style="text-align:center">6<br>6</td><td style="text-align:center">5<br>6</td><td style="text-align:center">4<br>6</td><td style="text-align:center">3<br>6</td><td style="text-align:center">2<br>6</td><td style="text-align:center">1<br>6</td></tr><tr><td style="text-align:center">8<br>5</td><td style="text-align:center">7<br>5</td><td style="text-align:center">6<br>5</td><td style="text-align:center">5<br>5</td><td style="text-align:center">4<br>5</td><td style="text-align:center">3<br>5</td><td style="text-align:center">2<br>5</td><td style="text-align:center">1<br>5</td></tr><tr><td style="text-align:center">8<br>4</td><td style="text-align:center">7<br>4</td><td style="text-align:center">6<br>4</td><td style="text-align:center">5<br>4</td><td style="text-align:center">4<br>4</td><td style="text-align:center">3<br>4</td><td style="text-align:center">2<br>4</td><td style="text-align:center">1<br>4</td></tr><tr><td style="text-align:center">8<br>3</td><td style="text-align:center">7<br>3</td><td style="text-align:center">6<br>3</td><td style="text-align:center">5<br>3</td><td style="text-align:center">4<br>3</td><td style="text-align:center">3<br>3</td><td style="text-align:center">2<br>3</td><td style="text-align:center">1<br>3</td></tr><tr><td style="text-align:center">8<br>2</td><td style="text-align:center">7<br>2</td><td style="text-align:center">6<br>2</td><td style="text-align:center">5<br>2</td><td style="text-align:center">4<br>2</td><td style="text-align:center">3<br>2</td><td style="text-align:center">2<br>2</td><td style="text-align:center">1<br>2</td></tr><tr><td style="text-align:center">8<br>1</td><td style="text-align:center">7<br>1</td><td style="text-align:center">6<br>1</td><td style="text-align:center">5<br>1</td><td style="text-align:center">4<br>1</td><td style="text-align:center">3<br>1</td><td style="text-align:center">2<br>1</td><td style="text-align:center">1<br>1</td></tr></tbody></table><p>对照方圆图中的方图，规律：</p><ol><li>每行的外卦（六十四卦分上下卦，下卦称为内卦，上卦称为外卦），从右到左以先天八卦次序依次排列。</li><li>每列的内卦，从下到上一先天八卦次序一次排列。</li></ol><h3 id="圆图">圆图</h3><ol><li>首先用方图最下面的第一横列的乾、夬、大有、大壮、小畜、需、泰等八个卦，依次序放到圆圈的顶端，从左边开始，顺原次序向左排列。又将第二横列的履、兑、睽、归妹、中孚、节、损、临等八个卦的履卦紧接在泰卦后面，依原次序排列下去，然后将第三、四横列的每个卦，都照这个方法排列，最后复卦紧靠了中线下端的左边为止。排列成了左边的半个圆圈。</li><li>排列右半个圆圈，排列的次序不同了，不从第五横列开始，而从第八横列。将否、萃、晋、豫、观、比、剥、坤等八个卦，以逆次序接在复卦后面，即排成复、坤、剥、比、观、豫、晋、萃、否的次序。然后再用第七横列，找第八横列的排法排下去，第六、第四横列均如此。</li><li>注意，如果是画卦，还是要内卦在内圈，外卦在外圈。</li></ol><h1>五行</h1><h2 id="五行相生相克">五行相生相克</h2><p>相生：木生火，火生土，土生金，金生水，水生木。</p><p>相克：木克土，土克水，水克火，火克金，金克木。</p><p><img src="/2021/zhou-yi-bi-ji/%E4%BA%94%E8%A1%8C%E7%9B%B8%E7%94%9F%E7%9B%B8%E5%85%8B%E5%9B%BE.png" alt="五行相生相克图"></p><h2 id="五行方位">五行方位</h2><p>东方木，西方金，北方水，南方火，中央土。</p><p><img src="/2021/zhou-yi-bi-ji/%E4%BA%94%E8%A1%8C%E6%96%B9%E4%BD%8D%E5%9B%BE.png" alt="五行方位图"></p><h1>干支</h1><h2 id="天干">天干</h2><p>甲、乙、丙、丁、戊、己、庚、辛、壬、癸。</p><h3 id="天干五行配">天干五行配</h3><p>严格来说，五行和八卦两种体系是分开的。但几千年来，大家都把它混合在一起了。</p><blockquote><p>东方甲乙木、南方丙丁火、西方庚辛金、北方壬癸水、中央戊己土。</p></blockquote><table><thead><tr><th style="text-align:center">方位</th><th style="text-align:center">天干</th><th style="text-align:center">五行</th></tr></thead><tbody><tr><td style="text-align:center">东</td><td style="text-align:center">甲乙</td><td style="text-align:center">木</td></tr><tr><td style="text-align:center">南</td><td style="text-align:center">丙丁</td><td style="text-align:center">火</td></tr><tr><td style="text-align:center">西</td><td style="text-align:center">庚辛</td><td style="text-align:center">金</td></tr><tr><td style="text-align:center">北</td><td style="text-align:center">壬癸</td><td style="text-align:center">水</td></tr><tr><td style="text-align:center">中</td><td style="text-align:center">戊己</td><td style="text-align:center">土</td></tr></tbody></table><h3 id="天干的阴阳">天干的阴阳</h3><table><thead><tr><th>天干</th><th>阴阳</th><th>五行</th></tr></thead><tbody><tr><td>甲</td><td>阳</td><td>阳木</td></tr><tr><td>乙</td><td>阴</td><td>阴木</td></tr><tr><td>丙</td><td>阳</td><td>阳火</td></tr><tr><td>丁</td><td>阴</td><td>阴火</td></tr><tr><td>戊</td><td>阳</td><td>阳土</td></tr><tr><td>己</td><td>阴</td><td>阴土</td></tr><tr><td>庚</td><td>阳</td><td>阳金</td></tr><tr><td>辛</td><td>阴</td><td>阴金</td></tr><tr><td>壬</td><td>阳</td><td>阳水</td></tr><tr><td>癸</td><td>阴</td><td>阴水</td></tr></tbody></table><p><img src="/2021/zhou-yi-bi-ji/%E5%A4%A9%E5%B9%B2%E9%98%B4%E9%98%B3%E4%BA%94%E8%A1%8C%E5%9B%BE.png" alt="天干阴阳五行图"></p><h2 id="地支">地支</h2><p>子、丑、寅、卯、辰、巳、午、未、申、酉、戌、亥。</p><h3 id="黄道十二次">黄道十二次</h3><p>地支有十二位，代表十二个月。实际上地支是什么？是天文上黄道十二次的代名。</p><h3 id="六十花甲">六十花甲</h3><p>六十花甲是根据干支来的，如甲子、乙丑、丙寅……这样天干与地支配起来，便可以代表太阳系统这个天体和地球产生万有的变化；其中以气象的变化是最大的，也最显著，容易见到。万有的变化，各有不同，于是用干支配合，而且是天干的阳配地支的阳，天干的阴配地支的阴，阳配阳，阴配阴，依照次序轮流配合，完全相互配合，刚好满六十个相配，成一周期，又从甲子开始。</p><h3 id="纳甲">纳甲</h3><p>把五行、八卦、天干、地支，归纳到一起名为纳甲。</p><h1>修订记录</h1><ul><li><p>2021-01-10</p><p>从其它网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 周易 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 周易 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim 插件介绍</title>
      <link href="2021/vim-cha-jian-jie-shao/"/>
      <url>2021/vim-cha-jian-jie-shao/</url>
      
        <content type="html"><![CDATA[<p>介绍一些 vim 实用的插件，本文所介绍插件均以 vim-plug 安装。</p><h1>vim-plug 插件管理</h1><p><a href="https://github.com/junegunn/vim-plug">vim-plug</a> 是一个 vim 插件管理器，利用异步并行可以快速地安装、更新和卸载插件。</p><h2 id="安装">安装</h2><ol><li><p>下载<a href="https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim">plug.vim</a>文件，根据不同操作系统，放置在相应的 autoload 目录中。</p><ul><li><p><strong>Linux</strong></p><p>用户配置： <em>~/.vim/autoload</em></p><p>全局配置： <em>安装位置/autolaod</em></p></li><li><p><strong>Windows</strong></p><p>用户配置： <em>~\vimfiles\autoload</em></p><p>全局配置： <em>安装位置\autoload</em></p></li></ul></li><li><p>结构目录如下，之后安装的插件将存放在 plugged 目录中。</p></li></ol><pre class="line-numbers language-none"><code class="language-none">~&#x2F;.vim+----- autoload|      +-- plug.vim+----- plugged       +-- drawit       +-- ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注</strong>： plugged 目录是由 vimrc 中 <code>call plug#begin()</code> 中定义，可修改。</p><ol start="3"><li>在 vimrc 文件中的配置。</li></ol><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">call plug#begin(&#39;~&#x2F;.vim&#x2F;plugged&#39;)&quot; Shorthand notation for pluginPlug &#39;vim-scripts&#x2F;DrawIt&#39;call plug#end()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="插件管理">插件管理</h2><p>以 vim 画图插件 DrawIt 为例。</p><p><strong>安装插件</strong></p><p>vim 可以在 GitHub 上面找到几乎所有的插件。</p><p>vim 官网的所有插件都在 <em><a href="https://github.com/vim-scripts/">https://github.com/vim-scripts/</a></em> 中。</p><p><a href="https://vimawesome.com/">vim Awesome</a> 几乎网罗了网络上所有的插件，并提供各种管理工具的下载方式。</p><p>若安装新插件，只需在 <code>call plug#begin()</code> 和 <code>call plug#end()</code> 之间添加插件github 缩写地址 <code>Plug 'vim-scripts/DrawIt'</code>，然后执行命令:</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugInstall<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>即可安装所有添加插件。</p><p>若要安装指定的插件，可执行:</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugInstall DrawIt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>更新插件</strong></p><p>批量更新所有已安装插件：</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugUpdate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>更新 vim-plug 插件自身：</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugUpgrade<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>插件卸载</strong></p><p>若要卸载插件，需要在 vimrc 中注释掉或删除相应的插件，然后执行：</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugClean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>插件状态</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">:PlugStatus<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1>fzf 模糊搜索</h1><p>fzf 全称 Fuzzy finder，由 golang 编写的，用于模糊搜索的工具。结合其他工具可以完成非常多得工作，如 ag、fasd、ripgrep。</p><p>类似工具有 CtrlP、LeaderF。</p><h2 id="安装-2">安装</h2><p>有很多方式可以安装 <a href="https://github.com/junegunn/fzf">fzf</a>，由于 fzf 是独立于 vim可以运行在各个平台的工具，所以可以独立于 vim 安装。</p><p><strong>使用 git 安装</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone --depth <span class="token number">1</span> https://github.com/junegunn/fzf.git ~/.fzf~/.fzf/install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>使用 vim-plug 安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;junegunn&#x2F;fzf&#39;, &#123; &#39;do&#39;: &#123; -&gt; fzf#install() &#125; &#125;Plug &#39;junegunn&#x2F;fzf.vim&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>我们使用 vim-plug 安装，同时安装插件 fzf.vim。使用 vim-plug 安装方式，我们就可以通过 <code>:PlugUpdate fzf</code> 指令更新。</p><h2 id="配置">配置</h2><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; 在当前目录搜索文件nnoremap &lt;silent&gt; &lt;Leader&gt;f :Files&lt;CR&gt;&quot;切换Buffer中的文件nnoremap &lt;silent&gt; &lt;Leader&gt;b :Buffers&lt;CR&gt;&quot;在当前所有加载的Buffer中搜索包含目标词的所有行，:BLines只在当前Buffer中搜索nnoremap &lt;silent&gt; &lt;Leader&gt;p :Lines&lt;CR&gt;&quot;在Vim打开的历史文件中搜索，相当于是在MRU中搜索，:History：命令历史查找nnoremap &lt;silent&gt; &lt;Leader&gt;h :History&lt;CR&gt;&quot; 调用 Rg 进行搜索，包含隐藏文件。需要安装 ripgrep 工具，&quot; https:&#x2F;&#x2F;github.com&#x2F;BurntSushi&#x2F;ripgrepcommand! -bang -nargs&#x3D;* Rg  \ call fzf#vim#grep(  \   &#39;rg --column --line-number --no-heading --color&#x3D;always --smart-case --hidden &#39;.shellescape(&lt;q-args&gt;), 1,  \   &lt;bang&gt;0 ? fzf#vim#with_preview(&#39;up:60%&#39;)  \           : fzf#vim#with_preview(&#39;right:50%:hidden&#39;, &#39;?&#39;),  \   &lt;bang&gt;0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1>主题美化</h1><h2 id="spaceline-状态栏">spaceline 状态栏</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;glepnir&#x2F;spaceline.vim&#39;Plug &#39;ryanoasis&#x2F;vim-devicons&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>配置</strong></p><p>配置说明可参考 <a href="https://github.com/glepnir/spaceline.vim">spaceline</a>。</p><p>使用 vim-devicons 需要先 <a href="https://www.nerdfonts.com/">安装字体</a> 并设置 guifont。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">set guifont&#x3D;DaddyTimeMono_Nerd_Font_Mono:h11:cANSI:qDRAFTlet g:spaceline_colorscheme &#x3D; &#39;space&#39;let g:spaceline_seperate_style &#x3D; &#39;curve&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="airline">airline</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;vim-airline&#x2F;vim-airline&#39;Plug &#39;vim-airline&#x2F;vim-airline-themes&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>配置</strong></p><p>配置说明参考 <a href="https://github.com/vim-airline/vim-airline">airline</a>。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; vim-airlinelet g:airline_powerline_fonts &#x3D; 1let g:airline#extensions#tabline#enabled &#x3D; 1let g:airline#extensions#tabline#buffer_nr_show &#x3D; 1&quot; vim-airline-themes 使用 solarized 主题let g:airline_theme&#x3D;&quot;solarized&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="vim-colorschemes-配色">vim-colorschemes 配色</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;flazz&#x2F;vim-colorschemes&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>配置</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">set background&#x3D;lightcolorscheme solarized<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1>Markdown</h1><h2 id="vim-markdown">vim-markdown</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;godlygeek&#x2F;tabular&#39;Plug &#39;plasticboy&#x2F;vim-markdown&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>配置</strong></p><p>配置说明可参考 <a href="https://github.com/plasticboy/vim-markdown">vim-markdown</a>。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; 支持 LaTeX 数学语法let g:vim_markdown_math &#x3D; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="vim-markdown-toc-目录">vim-markdown-toc 目录</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;mzlogin&#x2F;vim-markdown-toc&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>配置</strong></p><p>配置说明可参考 <a href="https://github.com/mzlogin/vim-markdown-toc">vim-markdown-toc</a>。</p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; 存储时取消自动更新let g:vmt_auto_update_on_save &#x3D; 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="markdown-preview-预览">markdown-preview 预览</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">&quot; 需要安装 nodejs 和 yarnPlug &#39;iamcco&#x2F;markdown-preview.nvim&#39;, &#123; &#39;do&#39;: &#39;cd app &amp;&amp; yarn install&#39;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>配置</strong></p><p>同类型的还有 vim-instant-markdown，体验较差。本插件配置说明可参考<a href="https://github.com/iamcco/markdown-preview.nvim">markdown-preview</a>。</p><h2 id="pangu-排版">pangu 排版</h2><p><strong>安装</strong></p><pre class="line-numbers language-vimscript" data-language="vimscript"><code class="language-vimscript">Plug &#39;hotoo&#x2F;pangu.vim&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>配置</strong></p><p>配置说明可参考 <a href="https://github.com/hotoo/pangu.vim">pangu</a>。</p><p>有一些问题：</p><ul><li>引用图片时，地址不能包含中文。引用时的方括号一定要在同一行。</li></ul><h1>修订记录</h1><ul><li><p>2021-01-08</p><p>创建，增加 vim-plug、fzf。</p></li><li><p>2021-01-09</p><p>增加 spceline， vim-markdown，vim-markdown-toc，markdown-preview，pangu，vim-airline，vim-airline-theme，vim-colorschemes。</p></li><li><p>2021-01-10</p><p>从其它网站迁移。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> vim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim插件 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
